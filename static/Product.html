<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Profile</title>
    <script type="text/javascript" src="http://code.jquery.com/jquery-latest.min.js"></script>
    <script type="text/javascript" src="/js/cookie.js"></script>
    <link rel="stylesheet" href="/css/styles.css">
    <link rel="stylesheet" href="/css/product.css">
    <script type="text/javascript">
        para = new URLSearchParams(window.location.search);
        id = para.get("id");
        name = "";
        comments = [];
        $.ajax({
            url: "http://localhost:8080/comments/" + id,
            type: "GET",
            success: function (response) {
                comments = response;
                table = document.getElementById('comments')
                for (let i = 0; i < response.length; i++) {
                    row = table.insertRow();
                    cell = row.insertCell();
                    userID = response[i].userID;
                    name = "";
                    // console.log("id: " + userID)
                    // $.ajax({
                    //     url: "http://localhost:8080/users/" + userID,
                    //     type: "GET",
                    //     success: function (response) {
                    //         console.log(response);
                    //         name = response.firstName + response.lastName;
                    //     },
                    //     error: function (response) {
                    //         //alert(response)
                    //     }
                    // });
                    //cell.innerHTML = "<strong>"+ name +"</strong>" + ": <br>" + response[i].text;
                    cell.innerHTML = "<strong>"+ userID +"</strong>" + ": <br>" + response[i].text;
                }
            },
            error: function (response) {
                //todo response message
                alert(response)
            }
        });
        $.ajax({
            url: "http://localhost:8080/products/" + id,
            type: "GET",
            success: function (response) {
                console.log(response);
                document.getElementById('title').innerHTML = response.title;
                document.getElementById('price').innerHTML = '$' + response.price;
                document.getElementById('rating').innerHTML = "Rating: " + response.rating;
                document.getElementById('description').innerHTML = response.description;
                document.getElementById('total-rating').innerHTML = "Rating: " + response.rating + "<br>Based on " + comments.length + " reviews";
            },
            error: function (response) {
                //todo response message
                alert(response)
            }
        });
    </script>
</head>

<header>
    <div id="logo-place">
        <a id="logo" href="#">digital</a>
    </div>
    <div>
        <p id="header-login"><strong><a class="authorization" href="#">Sign in</a></strong>&nbsp or &nbsp<strong><a class="authorization" href="#">Create an Account</a></strong></p>
        <form action="" target="_self" method="post" id="forms">
            <input type="text" id="search-field" name="searchedProduct" placeholder="Search all products...">
            <input type="image" id="glass-pic" src="/img/magnifying-glass.png" alt="Submit"/>
            <input type="button" id="cart-field" value="Cart">
        </form>
    </div>

    <div>
        <nav>
            <ul class="navbar-lists">
                <li><a href="#">Cameras</a></li>
                <li><a href="#">cases</a></li>
                <li><a href="#">video</a></li>
                <li><a href="#">Accessories</a></li>
                <li><a href="#">sport optic</a></li>
                <li><a href="#">lifestyle</a></li>
            </ul>
        </nav>
    </div>
</header>
<body>

<section class="product">
    <div class="info">
        <img src="../img/camera.jpg" alt="camera image">
        <div class="right-col">
            <h1 id="title"></h1>
            <h2 id="price"></h2>
            <h3 id="rating"></h3>
            <input type="button" id="cart" value="ADD TO CART"><br>
            <input type="button" id="buy" value="BUY IT NOW"><br>
            <hr>
            <div id="description">
            </div>
        </div>
        <div class="reviews">
            <hr>
            <h2>CUSTOMER REVIEWS</h2>
            <table id="write-review">
                <tr>
                    <td id="total-rating"></td>
                </tr>
                <tr>
                    <td><a href="#">Write a review > </a></td>
                </tr>
            </table>
            <table id="comments">
            </table>
        </div>
    </div>
</section>

</body>
</html>

